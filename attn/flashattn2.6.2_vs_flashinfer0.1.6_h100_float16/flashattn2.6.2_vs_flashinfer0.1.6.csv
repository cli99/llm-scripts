Batch Size,Seq Length,flashattn,flashinfer,Speedup
1,1,13.518324121832848,9.660022333264351,1.3994091996332563
1,2,13.330429792404175,9.478582069277763,1.406373832602149
1,4,12.76109367609024,9.328927844762802,1.3679057109713024
1,8,12.826081365346909,9.212493896484375,1.3922485604296067
1,16,12.694252654910088,9.064143523573875,1.4004911354167204
1,32,12.825923040509224,8.97914171218872,1.428413032294467
1,64,12.638615444302559,8.97413119673729,1.408338608744383
1,128,12.993337586522102,8.92486423254013,1.4558582907231556
1,256,18.08461733162403,12.924093753099442,1.3992948114669161
1,512,18.420564010739326,12.733777984976768,1.44659063731689
1,1024,18.822867423295975,12.973658740520477,1.4508526699956068
1,2048,18.020635470747948,12.356387451291084,1.4584064753379857
1,4096,20.275795832276344,14.805225655436516,1.369502654276061
1,8192,25.310590863227844,18.951985985040665,1.3355112695422107
1,16384,40.84961488842964,35.33238545060158,1.1561521920319175
1,32768,63.12087178230286,57.67501890659332,1.0944230791589211
2,1,12.577734887599945,8.894260972738266,1.4141405256886288
2,2,12.97440379858017,8.95288772881031,1.449186473860122
2,4,12.583108618855476,8.924035355448723,1.4100245144336685
2,8,12.913625687360764,9.021013975143433,1.431504897669271
2,16,12.654149904847145,8.915457874536514,1.4193494134483804
2,32,12.912219390273094,8.87332484126091,1.4551726237082347
2,64,12.631844729185104,8.92268493771553,1.4156999622155468
2,128,12.594787403941154,9.242603555321693,1.3626882651143621
2,256,17.958367243409157,12.298133224248886,1.4602514801189246
2,512,18.04061233997345,12.316051870584488,1.4648048359605754
2,1024,17.944900318980217,12.585856020450592,1.425798951602639
2,2048,18.139155581593513,14.600427821278572,1.2423715115496563
2,4096,21.90491184592247,18.932558596134186,1.156996912736095
2,8192,38.06953318417072,35.12394614517689,1.0838626453536546
2,16384,59.907110407948494,57.18686617910862,1.0475676394002793
2,32768,102.98500768840313,98.37503544986248,1.0468612002776878
4,1,12.560738250613213,8.901627734303474,1.4110608335382218
4,2,12.694569304585457,9.157229214906693,1.3862893465547927
4,4,13.047950342297554,9.038280695676804,1.4436319009807537
4,8,12.602675706148148,9.015575051307678,1.3978781868517831
4,16,12.857550755143166,8.926047012209892,1.4404529505116195
4,32,12.677963823080063,8.783331140875816,1.4434118012560664
4,64,12.76402734220028,8.975006639957428,1.4221746962697317
4,128,12.520747259259224,9.038234129548073,1.3853090194163051
4,256,17.855288460850716,12.276265770196915,1.4544560043818855
4,512,18.008258193731308,12.243464589118958,1.470846594332102
4,1024,17.915014177560806,14.582453295588493,1.2285322513585888
4,2048,20.25490626692772,18.424196168780327,1.0993644488680334
4,4096,37.06593066453934,35.47467291355133,1.0448561641390115
4,8192,59.366375207901,56.690638884902,1.047198909301966
4,16384,101.39383375644684,99.20768439769745,1.022036088958449
4,32768,187.2227992862463,182.88970924913883,1.0236923665902098
8,1,12.905457988381386,8.872738108038902,1.4545068085226978
8,2,12.775510549545288,9.062821045517921,1.4096615706500686
8,4,12.557804584503174,9.006857872009277,1.394249222420753
8,8,12.79299147427082,8.872225880622864,1.4419145371637794
8,16,13.400083407759666,8.859466761350632,1.5125157945416585
8,32,12.594042345881462,8.889306336641312,1.4167632286412946
8,64,12.742914259433746,9.049652144312859,1.4081109479375815
8,128,12.5848688185215,8.856402710080147,1.4209910310647573
8,256,18.064631149172783,12.298738583922386,1.4688198326930781
8,512,18.081124871969223,15.100287273526192,1.1974027079384797
8,1024,19.251229241490364,19.447915256023407,0.9898865244966487
8,2048,35.81324592232704,36.04424186050892,0.9935913220459504
8,4096,56.62362091243267,57.97417834401131,0.9767041557093814
8,8192,99.14900176227093,98.85502979159355,1.0029737684698201
8,16384,183.1271778792143,183.7239321321249,0.9967518970120808
8,32768,352.6343498378992,351.4610789716244,1.003338266842257
16,1,12.669237330555916,9.412495419383049,1.346001965054484
16,2,12.587178498506546,8.902624249458313,1.4138728251136086
16,4,12.682415544986725,9.120199829339981,1.3905852703124968
16,8,12.931739911437035,8.860714733600616,1.4594465909616443
16,16,12.75419257581234,9.021535515785217,1.4137496386835695
16,32,12.863464653491974,9.023966267704964,1.425477918676163
16,64,12.551117688417435,8.896412327885628,1.410806651696685
16,128,12.916270643472672,9.105177596211433,1.4185632852287244
16,256,18.16496253013611,16.054706647992134,1.131441572145318
16,512,18.489034846425056,20.207306370139122,0.9149678095516381
16,1024,34.8490197211504,36.94143146276474,0.9433586718553829
16,2048,56.405672803521156,58.414796367287636,0.9656059134207374
16,4096,98.54728356003761,100.14335624873638,0.9840621210583911
16,8192,182.50126391649246,184.21628512442112,0.9906901759159331
16,16384,350.74442625045776,353.9862670004368,0.9908419024911637
16,32768,687.1602032333612,688.8203322887421,0.9975898953942538
32,1,12.562219053506851,9.607523679733276,1.3075397440868555
32,2,12.623025104403496,9.40338708460331,1.3423913097304991
32,4,12.653926387429237,9.486395865678787,1.3339024184316812
32,8,12.689763680100441,9.344173595309258,1.3580402323080405
32,16,12.704059481620789,9.300075471401215,1.3660168157438304
32,32,12.943996116518974,9.525343775749207,1.3589006781543564
32,64,12.951027601957321,10.025054216384888,1.2918660909374675
32,128,12.807417660951614,11.125029996037483,1.1512254497752694
32,256,13.564620167016983,14.903871342539787,0.9101407181568852
32,512,29.526585713028908,31.8398792296648,0.9273460335716153
32,1024,51.15484818816185,53.209392353892326,0.9613875657127254
32,2048,93.5623049736023,95.30615992844105,0.9817025997464581
32,4096,177.30142921209335,179.89285290241241,0.9855946267541553
32,8192,345.7910194993019,347.3884053528309,0.9954017295081954
32,16384,683.7341841310263,681.5893575549126,1.0031468017396983
32,32768,1363.2442150264978,1351.8548756837845,1.008424971901627
64,1,13.63435760140419,15.746196731925009,0.8658825895246743
64,2,13.63077200949192,15.76865091919899,0.8644222057637085
64,4,13.703610748052597,15.844302251935003,0.8648920305959845
64,8,13.88457603752613,15.86371101438999,0.8752413621838809
64,16,13.908995315432549,15.918668359518051,0.8737536960568763
64,32,14.087222516536713,16.035540029406548,0.8785000374607317
64,64,14.549465849995613,16.823802143335342,0.86481436990504
64,128,17.01291650533676,20.746709778904915,0.8200296185101772
64,256,33.040307462215424,35.222843289375305,0.9380363530215569
64,512,54.136160761117935,57.54336714744568,0.940788894442042
64,1024,95.37926875054836,97.50466793775558,0.9782020775809009
64,2048,176.5811536461115,178.25990915298462,0.9905825403207605
64,4096,343.47835928201675,345.7312937825918,0.993483567900591
64,8192,676.9327167421579,674.2803286761045,1.0039336577877944
64,16384,1352.3565139621496,1335.6567453593016,1.0125030391684622
64,32768,2676.517106592655,2655.156711116433,1.008044871847598
128,1,24.047736078500748,28.693731874227524,0.8380832505129885
128,2,24.19562079012394,28.693778440356255,0.8432357850820407
128,4,24.35479313135147,28.583556413650513,0.8520560835362134
128,8,24.61319789290428,28.700949624180794,0.857574338661166
128,16,24.629198014736176,28.83843146264553,0.8540408325133224
128,32,25.22459253668785,29.477356001734734,0.8557277842423653
128,64,27.8299767524004,32.90558233857155,0.8457524460759479
128,128,35.26689484715462,43.97605545818806,0.8019567575970061
128,256,57.94107913970947,59.32471714913845,0.9766768713628992
128,512,98.5000841319561,99.19124655425549,0.9930320220149534
128,1024,177.84914001822472,180.94955012202263,0.9828658866423975
128,2048,341.66800789535046,341.21448174118996,1.0013291527131152
128,4096,662.8383323550224,661.5366693586111,1.0019676354413933
128,8192,1315.7436065375805,1300.989594310522,1.0113406074049942
128,16384,2628.3774618059397,2592.1963341534138,1.0139577111408662
128,32768,5229.913266375661,5160.1233426481485,1.0135248557240295
256,1,43.02705638110638,53.487904369831085,0.8044259143825241
256,2,43.15861500799656,53.43320779502392,0.8077114736131525
256,4,43.39567385613918,53.396644070744514,0.8127041429540932
256,8,44.26139406859875,53.55939269065857,0.8263983560126978
256,16,45.2678557485342,54.247668012976646,0.8344663910291154
256,32,49.05187524855137,57.25105293095112,0.8567855565505749
256,64,51.65313370525837,60.3166688233614,0.8563658224648585
256,128,60.2282490581274,72.85425439476967,0.8266950167628273
256,256,103.17523032426834,104.5842282474041,0.9865276251807047
256,512,181.90909177064896,179.7624584287405,1.0119414996917133
256,1024,338.0682598799467,333.9134342968464,1.012442822469391
256,2048,651.4318566769361,644.2413944751024,1.0111611303829555
256,4096,1276.594903320074,1259.4995461404324,1.013573134847113
256,8192,2549.338024109602,2508.4033142775297,1.0163190303565128
256,16384,5079.116029664874,4989.302149042487,1.0180012911504315
256,32768,10343.597270548344,9947.675606235862,1.0398004197145605
